<!DOCTYPE html>
<html lang="en" translate="no">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Notice Period Tracker — Inclusive, Global</title>
  <meta name="description"
    content="Global, inclusive notice period tracker. Day 1 = resignation date. Timezone aware. Calendar export. URL share. Mobile friendly." />
  <meta name="color-scheme" content="light dark" />

  <!-- Bootstrap 5.3.3 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet" />

  <style>
    :root {
      --grad: linear-gradient(90deg, #4ea1ff, #66d9a3);
    }

    body {
      background:
        radial-gradient(1100px 700px at 5% -10%, rgba(78, 161, 255, .10), transparent 60%),
        radial-gradient(900px 600px at 120% 10%, rgba(102, 217, 163, .10), transparent 60%),
        var(--bs-body-bg);
    }

    .card-elev {
      border: 1px solid rgba(125, 125, 125, 0.15);
      box-shadow: 0 14px 30px rgba(0, 0, 0, 0.08);
      border-radius: 1rem;
    }

    .btn-grad {
      background-image: var(--grad);
      color: #fff;
      border: 0;
    }

    .btn-grad:hover,
    .btn-grad:focus {
      color: #fff;
      filter: brightness(0.98);
    }

    .segmented .btn {
      border-radius: 9999px !important;
    }

    .segmented .btn-check+.btn {
      border: 1px solid var(--bs-border-color);
      background: transparent;
    }

    .segmented .btn-check:checked+.btn {
      background-image: var(--grad);
      color: #fff;
      border-color: transparent;
    }

    .kpi {
      border: 1px solid var(--bs-border-color);
      border-radius: 0.75rem;
      padding: 0.9rem;
      height: 100%;
      background: var(--bs-body-bg);
    }

    .kpi .kpi-label {
      font-size: 0.8rem;
      color: var(--bs-secondary-color);
      margin-bottom: 0.25rem;
    }

    .kpi .kpi-value {
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      font-weight: 700;
      font-size: 1.1rem;
    }

    .kpi .kpi-meta {
      font-size: 0.8rem;
      color: var(--bs-secondary-color);
    }

    .pill {
      border: 1px solid var(--bs-border-color);
      border-radius: 9999px;
      padding: 0.15rem 0.55rem;
      font-size: 0.8rem;
      color: var(--bs-secondary-color);
      background: color-mix(in srgb, var(--bs-secondary-bg) 60%, transparent);
    }

    .field-hint {
      min-height: 1.25rem;
    }

    .title-gradient {
      background-image: var(--grad);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    /* Make action column sticky on desktop for nicer UX */
    @media (min-width: 992px) {
      .actions-sticky {
        position: sticky;
        top: 1rem;
      }
    }
  </style>
</head>

<body>
  <header class="container py-4">
    <h1 class="text-center fw-semibold mb-1">
      <span class="title-gradient">Notice Period Tracker</span>
    </h1>
    <p class="text-center text-secondary mb-0">
      Inclusive — <strong>Day&nbsp;1 = Resignation Date</strong>. Global timezone aware. Calendar export. URL share.
    </p>
  </header>

  <main class="container pb-5">
    <section class="card card-elev p-3 p-md-4">
      <!-- Controls -->
      <div class="row g-4">
        <!-- Left column: inputs -->
        <div class="col-12 col-lg-8">
          <div class="row g-4">
            <!-- Notice period -->
            <div class="col-12">
              <label class="form-label mb-2">Notice period</label>

              <!-- Segmented presets -->
              <div class="segmented btn-group w-100 mb-2" role="group" aria-label="Notice period presets">
                <input type="radio" class="btn-check" name="preset" id="preset30" autocomplete="off" value="30" />
                <label class="btn" for="preset30">30</label>

                <input type="radio" class="btn-check" name="preset" id="preset60" autocomplete="off" value="60" />
                <label class="btn" for="preset60">60</label>

                <input type="radio" class="btn-check" name="preset" id="preset90" autocomplete="off" value="90"
                  checked />
                <label class="btn" for="preset90">90</label>
              </div>

              <!-- Custom days -->
              <div class="input-group">
                <span class="input-group-text">Days</span>
                <input id="periodDays" type="number" min="1" max="365" step="1" class="form-control" value="90"
                  aria-label="Notice period days" />
              </div>
            </div>

            <!-- Resignation date (visible dd-MM-yyyy + hidden native date) -->
            <div class="col-12">
              <label for="dateDisplay" class="form-label mb-2">Resignation date (calendar)</label>
              <div class="input-group">
                <span class="input-group-text"><i class="bi bi-calendar-event"></i></span>
                <input id="dateDisplay" type="text" inputmode="numeric" pattern="\\d{2}-\\d{2}-\\d{4}"
                  placeholder="dd-mm-yyyy" class="form-control" aria-describedby="dateHelp" />
                <button id="openPicker" type="button" class="btn btn-outline-secondary" title="Open date picker">
                  Pick
                </button>
              </div>
              <div id="dateHelp" class="form-text text-secondary field-hint"></div>
              <div id="dateError" class="text-danger small" role="alert" style="display: none"></div>

              <!-- Hidden native date for reliability -->
              <input id="resignDateISO" type="date" class="d-none" />
            </div>

            <!-- Timezone -->
            <div class="col-12">
              <label for="tz" class="form-label mb-2">Timezone</label>
              <select id="tz" class="form-select"></select>
              <div id="tzNow" class="form-text text-secondary field-hint"></div>
            </div>
          </div>
        </div>

        <!-- Right column: actions -->
        <div class="col-12 col-lg-4">
          <div class="d-grid gap-2 actions-sticky">
            <button id="calcBtn" class="btn btn-grad btn-lg fw-semibold">
              Calculate
            </button>
            <button id="copyBtn" class="btn btn-outline-secondary">
              Copy
            </button>
            <button id="icsBtn" class="btn btn-outline-secondary">
              .ics
            </button>
            <button id="gcalBtn" class="btn btn-outline-secondary">
              Google Cal
            </button>
            <button id="shareBtn" class="btn btn-outline-secondary">
              Share
            </button>
            <button id="resetBtn" class="btn btn-outline-secondary">
              Reset
            </button>
          </div>
        </div>
      </div>

      <hr class="my-4" />

      <!-- KPIs -->
      <div class="row g-3" aria-live="polite">
        <div class="col-12 col-sm-6 col-xl-3">
          <div class="kpi">
            <div class="kpi-label">Today</div>
            <div class="kpi-value" id="todayText">—</div>
            <div class="kpi-meta" id="nowTime">—</div>
          </div>
        </div>
        <div class="col-12 col-sm-6 col-xl-3">
          <div class="kpi">
            <div class="kpi-label">Inclusive Day #</div>
            <div class="kpi-value" id="dayNumber">—</div>
            <div class="kpi-meta">Day 1 = Resignation Date</div>
          </div>
        </div>
        <div class="col-12 col-sm-6 col-xl-3">
          <div class="kpi">
            <div class="kpi-label">Days Completed</div>
            <div class="kpi-value" id="done">—</div>
            <div class="kpi-meta">
              of <span id="totalDaysMeta">—</span>
            </div>
          </div>
        </div>
        <div class="col-12 col-sm-6 col-xl-3">
          <div class="kpi">
            <div class="kpi-label">Days Remaining</div>
            <div class="kpi-value" id="left">—</div>
            <div class="kpi-meta" id="statusFlag">—</div>
          </div>
        </div>
      </div>

      <!-- Progress -->
      <div class="mt-3">
        <div class="progress" style="height: 14px" role="progressbar" aria-valuemin="0" aria-valuemax="365"
          aria-valuenow="0">
          <div id="bar" class="progress-bar" style="width: 0%; background-image: var(--grad)"></div>
        </div>
      </div>

      <!-- Start/End -->
      <div class="row g-3 mt-3">
        <div class="col-12 col-md-6">
          <div class="text-secondary">Start (Day 1)</div>
          <div><strong id="startText">—</strong></div>
        </div>
        <div class="col-12 col-md-6">
          <div class="text-secondary">End (Final Day)</div>
          <div><strong id="endText">—</strong></div>
        </div>
      </div>

      <!-- Pills -->
      <div class="d-flex flex-wrap gap-2 mt-3">
        <span class="pill" id="percentPill">—%</span>
        <span class="pill" id="weekPill">— weeks</span>
        <span class="pill" id="etaPill">ETA: —</span>
        <span class="pill" id="urlPill" title="Shareable URL">URL</span>
      </div>

      <details class="mt-3">
        <summary>About the calculation</summary>
        <p class="text-secondary mb-0">
          Counting is <strong>inclusive</strong> (Day 1 = resignation date) and
          uses date ordinals in the selected timezone to avoid DST issues.
        </p>
      </details>
    </section>
  </main>

  <!-- Bootstrap JS (no jQuery needed) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>

  <script>
    /*************** TZ-safe ordinal math + state ***************/
    const DAY_MS = 86400000;
    const STORAGE_KEY = "notice-tracker:v3";

    const els = {
      // Inputs
      dateDisplay: byId("dateDisplay"),
      dateISO: byId("resignDateISO"),
      openPicker: byId("openPicker"),
      dateHelp: byId("dateHelp"),
      dateError: byId("dateError"),
      periodDays: byId("periodDays"),
      tz: byId("tz"),
      tzNow: byId("tzNow"),
      // Buttons
      calcBtn: byId("calcBtn"),
      copyBtn: byId("copyBtn"),
      icsBtn: byId("icsBtn"),
      gcalBtn: byId("gcalBtn"),
      shareBtn: byId("shareBtn"),
      resetBtn: byId("resetBtn"),
      // KPIs
      todayText: byId("todayText"),
      nowTime: byId("nowTime"),
      dayNumber: byId("dayNumber"),
      done: byId("done"),
      left: byId("left"),
      statusFlag: byId("statusFlag"),
      bar: byId("bar"),
      totalDaysMeta: byId("totalDaysMeta"),
      startText: byId("startText"),
      endText: byId("endText"),
      percentPill: byId("percentPill"),
      weekPill: byId("weekPill"),
      etaPill: byId("etaPill"),
      urlPill: byId("urlPill"),
    };

    // Helpers
    function byId(id) { return document.getElementById(id); }
    function detectTimeZone() {
      try { return Intl.DateTimeFormat().resolvedOptions().timeZone || "UTC"; }
      catch { return "UTC"; }
    }
    function getAllTimeZones() {
      return [
        "Pacific/Honolulu", "America/Anchorage", "America/Los_Angeles", "America/Denver", "America/Chicago", "America/New_York",
        "America/Sao_Paulo", "Europe/London", "Europe/Paris", "Europe/Berlin", "Europe/Madrid", "Europe/Rome", "Europe/Warsaw",
        "Africa/Cairo", "Europe/Moscow", "Asia/Dubai", "Asia/Karachi", "Asia/Kolkata", "Asia/Dhaka", "Asia/Bangkok",
        "Asia/Hong_Kong", "Asia/Shanghai", "Asia/Singapore", "Asia/Taipei", "Asia/Tokyo", "Asia/Seoul",
        "Australia/Perth", "Australia/Adelaide", "Australia/Sydney", "Pacific/Auckland"
      ];
    }
    function fmtDate(utcDate, timeZone) {
      return new Intl.DateTimeFormat(undefined, { timeZone, day: "2-digit", month: "short", year: "numeric" }).format(utcDate);
    }
    function fmtTime(now, timeZone) {
      return new Intl.DateTimeFormat(undefined, { timeZone, hour: "2-digit", minute: "2-digit", second: "2-digit", hour12: false }).format(now);
    }
    function partsNow(timeZone) {
      const parts = new Intl.DateTimeFormat("en-CA", { timeZone, year: "numeric", month: "2-digit", day: "2-digit", hour: "2-digit", minute: "2-digit", second: "2-digit", hour12: false }).formatToParts(new Date());
      const m = Object.fromEntries(parts.map(p => [p.type, p.value]));
      return { y: +m.year, m: +m.month, d: +m.day, hh: +m.hour, mm: +m.minute, ss: +m.second };
    }
    function todayOrdinal(timeZone) {
      const { y, m, d } = partsNow(timeZone);
      return Math.floor(Date.UTC(y, m - 1, d) / DAY_MS);
    }
    function ymdToOrdinal(y, m, d) { return Math.floor(Date.UTC(y, m - 1, d) / DAY_MS); }
    function ordinalToUTCDate(ord) { return new Date(ord * DAY_MS); }
    function isoToYmd(iso) { const m = /^(\d{4})-(\d{2})-(\d{2})$/.exec(iso || ""); if (!m) return null; return { y: +m[1], m: +m[2], d: +m[3] }; }
    function ymdToIso({ y, m, d }) { return `${y}-${String(m).padStart(2, "0")}-${String(d).padStart(2, "0")}`; }
    function isoFromUTC(d, tz) {
      const parts = new Intl.DateTimeFormat("en-CA", { timeZone: tz, year: "numeric", month: "2-digit", day: "2-digit" }).formatToParts(d);
      const m = Object.fromEntries(parts.map(p => [p.type, p.value]));
      return { y: +m.year, m: +m.month, d: +m.day };
    }

    // dd-MM-yyyy UI helpers
    function ddmmyyyyToIso(v) {
      const m = /^(\d{2})-(\d{2})-(\d{4})$/.exec(v.trim());
      if (!m) return null;
      return `${m[3]}-${m[2]}-${m[1]}`;
    }
    function isoToDdmmyyyy(iso) {
      const ymd = isoToYmd(iso); if (!ymd) return "";
      return `${String(ymd.d).padStart(2, "0")}-${String(ymd.m).padStart(2, "0")}-${ymd.y}`;
    }
    function maskDateInput(el) {
      el.addEventListener("input", () => {
        // keep only digits, insert dashes at 2,5
        let v = el.value.replace(/\D/g, "").slice(0, 8);
        if (v.length >= 5) v = v.replace(/^(\d{2})(\d{2})(\d{0,4}).*$/, "$1-$2-$3");
        else if (v.length >= 3) v = v.replace(/^(\d{2})(\d{0,2}).*$/, "$1-$2");
        el.value = v;
      });
    }

    // Bounds + validation
    function setDateBounds(tz) {
      const tOrd = todayOrdinal(tz);
      const minOrd = tOrd - 90;
      els.dateHelp.textContent = `Back-date allowed up to ${fmtDate(ordinalToUTCDate(minOrd), tz)} (90 days). No future dates.`;
      els.dateISO.max = ymdToIso(isoFromUTC(ordinalToUTCDate(tOrd), tz));
      els.dateISO.min = ymdToIso(isoFromUTC(ordinalToUTCDate(minOrd), tz));
    }
    function showError(msg) { els.dateError.textContent = msg; els.dateError.style.display = "block"; }
    function hideError() { els.dateError.style.display = "none"; }

    function validate(iso, days, tz) {
      hideError();
      const ymd = isoToYmd(iso);
      if (!ymd) return showError("Invalid date."), null;
      if (!Number.isFinite(days) || days < 1 || days > 365) return showError("Days must be 1–365."), null;

      const sOrd = ymdToOrdinal(ymd.y, ymd.m, ymd.d);
      const tOrd = todayOrdinal(tz);
      const minOrd = tOrd - 90;

      if (sOrd > tOrd) return showError("Future dates are not allowed."), null;
      if (sOrd < minOrd) return showError(`Date too far in the past. Minimum is ${fmtDate(ordinalToUTCDate(minOrd), tz)}.`), null;
      return { sOrd, ymd };
    }

    function compute(sOrd, total, tz) {
      const eOrd = sOrd + (total - 1);
      const tOrd = todayOrdinal(tz);

      let done = (tOrd - sOrd) + 1;
      if (tOrd < sOrd) done = 0;
      if (tOrd > eOrd) done = total;

      const left = Math.max(0, total - done);
      const pct = Math.round((done / total) * 100);

      let status = "On track", cls = "text-secondary";
      if (left <= 0) { status = "✅ Complete"; cls = "text-success"; }
      else if (left <= 14) { status = "⚠️ Final fortnight"; cls = "text-danger"; }
      else if (left <= 30) { status = "⏳ Home stretch"; cls = "text-warning"; }

      return { eOrd, done, left, pct, status, cls, tOrd };
    }

    function writeQuery({ start, days, tz }) {
      const u = new URL(location.href);
      u.searchParams.set("start", start);
      u.searchParams.set("days", String(days));
      u.searchParams.set("tz", tz);
      history.replaceState(null, "", u);
      els.urlPill.title = u.toString();
    }

    function saveState(state) { try { localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); } catch { } }
    function loadState() { try { return JSON.parse(localStorage.getItem(STORAGE_KEY) || "null"); } catch { return null; } }

    function render({ iso, days, tz }) {
      const v = validate(iso, days, tz); if (!v) return;

      const { eOrd, done, left, pct, status, cls, tOrd } = compute(v.sOrd, days, tz);
      const startUTC = ordinalToUTCDate(v.sOrd);
      const endUTC = ordinalToUTCDate(eOrd);
      const todayUTC = ordinalToUTCDate(tOrd);

      els.todayText.textContent = fmtDate(todayUTC, tz);
      els.nowTime.textContent = `Now: ${fmtTime(new Date(), tz)} ${tz}`;
      els.dayNumber.textContent = `${done} / ${days}`;
      els.done.textContent = done;
      els.left.textContent = left;
      els.statusFlag.textContent = status;
      els.statusFlag.className = `kpi-meta ${cls}`;

      els.bar.style.width = `${pct}%`;
      els.bar.parentElement.setAttribute("aria-valuenow", String(done));
      els.bar.parentElement.setAttribute("aria-valuemax", String(days));
      els.totalDaysMeta.textContent = String(days);

      els.startText.textContent = fmtDate(startUTC, tz);
      els.endText.textContent = fmtDate(endUTC, tz);
      els.percentPill.textContent = `${pct}%`;
      els.weekPill.textContent = `${(done / 7).toFixed(1)} weeks`;
      els.etaPill.textContent = `ETA: ${fmtDate(endUTC, tz)}`;

      writeQuery({ start: iso, days, tz });
      saveState({ iso, days, tz });
    }

    // Calendar exports
    function escapeICS(s) { return s.replace(/([,;])/g, "\\$1"); }
    function toICSDate(d) {
      const y = d.getUTCFullYear();
      const m = String(d.getUTCMonth() + 1).padStart(2, "0");
      const da = String(d.getUTCDate()).padStart(2, "0");
      return `${y}${m}${da}`;
    }
    function toICSDateTime(d) { return d.toISOString().replace(/[-:]/g, "").replace(/\.\d{3}Z$/, "Z"); }
    function addDays(dUTC, n) { return new Date(dUTC.getTime() + n * DAY_MS); }

    function downloadICS({ title, endUTCDate }) {
      const uid = crypto.randomUUID?.() || String(Date.now());
      const dtstamp = toICSDateTime(new Date());
      const dtstart = toICSDate(endUTCDate);
      const dtend = toICSDate(addDays(endUTCDate, 1));
      const desc = "Notice period final day (Inclusive: Day 1 = resignation date).";
      const ics =
        `BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//NoticePeriodTracker//v3//EN
CALSCALE:GREGORIAN
BEGIN:VEVENT
UID:${uid}
DTSTAMP:${dtstamp}
DTSTART;VALUE=DATE:${dtstart}
DTEND;VALUE=DATE:${dtend}
SUMMARY:${escapeICS(title)}
DESCRIPTION:${escapeICS(desc)}
END:VEVENT
END:VCALENDAR`;
      const blob = new Blob([ics], { type: "text/calendar;charset=utf-8" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url; a.download = "notice-period-end.ics"; a.click();
      setTimeout(() => URL.revokeObjectURL(url), 1000);
    }

    function openGoogleCalendar(title, endUTCDate) {
      const dates = `${toICSDate(endUTCDate)}/${toICSDate(addDays(endUTCDate, 1))}`;
      const u = new URL("https://calendar.google.com/calendar/render");
      u.searchParams.set("action", "TEMPLATE");
      u.searchParams.set("text", title);
      u.searchParams.set("dates", dates);
      u.searchParams.set("details", "Notice period final day (inclusive).");
      window.open(u.toString(), "_blank", "noopener");
    }

    /*************** Wiring & UX ***************/
    function initTimeZones() {
      const tzs = getAllTimeZones();
      const detected = detectTimeZone();
      for (const z of tzs) {
        const opt = document.createElement("option");
        opt.value = z;
        opt.textContent = z;
        els.tz.appendChild(opt);
      }
      // Default: Asia/Kolkata
      const defaultTZ = "Asia/Kolkata";
      els.tz.value = tzs.includes(defaultTZ) ? defaultTZ : detected;
      if (!tzs.includes(els.tz.value)) {
        const opt = document.createElement("option");
        opt.value = els.tz.value;
        opt.textContent = els.tz.value;
        els.tz.insertBefore(opt, els.tz.firstChild);
      }
    }

    function syncPresetRadiosFromDays(val) {
      const v = String(val);
      byId("preset30").checked = v === "30";
      byId("preset60").checked = v === "60";
      byId("preset90").checked = v === "90";
    }

    function recalc() {
      render({
        iso: els.dateISO.value,
        days: Number(els.periodDays.value),
        tz: els.tz.value,
      });
    }

    // Tick clock, midnight refresh in TZ
    function tickNow() {
      const tz = els.tz.value;
      const p = partsNow(tz);
      els.tzNow.textContent = `Now: ${fmtTime(new Date(), tz)} ${tz}`;
      if (p.hh === 0 && p.mm === 0 && p.ss < 2) recalc();
    }

    // Event hookups
    maskDateInput(els.dateDisplay);

    // Open native date picker for better UX (where supported)
    els.openPicker.addEventListener("click", () => {
      try { els.dateISO.showPicker?.(); } catch { /* fallback: focus */ els.dateISO.focus(); }
    });

    // When native picker changes, mirror to dd-MM-yyyy UI & recalc
    els.dateISO.addEventListener("change", () => {
      els.dateDisplay.value = isoToDdmmyyyy(els.dateISO.value);
      recalc();
    });

    // When user types dd-MM-yyyy, convert to ISO (if valid) and recalc
    els.dateDisplay.addEventListener("change", () => {
      const iso = ddmmyyyyToIso(els.dateDisplay.value);
      if (!iso) { showError("Use format dd-mm-yyyy, e.g., 17-10-2025."); return; }
      els.dateISO.value = iso;
      recalc();
    });

    // Preset radios
    document.querySelectorAll('input[name="preset"]').forEach(r => {
      r.addEventListener("change", () => {
        els.periodDays.value = r.value;
        recalc();
      });
    });

    // Custom days input
    els.periodDays.addEventListener("input", () => {
      const v = Number(els.periodDays.value);
      if ([30, 60, 90].includes(v)) syncPresetRadiosFromDays(v);
      else document.querySelectorAll('input[name="preset"]').forEach(r => r.checked = false);
    });
    els.periodDays.addEventListener("change", recalc);

    // Timezone change
    els.tz.addEventListener("change", () => { setDateBounds(els.tz.value); recalc(); });

    // Calculate button triggers same recompute
    els.calcBtn.addEventListener("click", recalc);

    // Copy (summary + URL)
    els.copyBtn.addEventListener("click", async () => {
      const summary = [
        "Notice Period — Inclusive Tracker",
        `Timezone: ${els.tz.value}`,
        `Today: ${els.todayText.textContent} (${els.nowTime.textContent.replace(/^Now:\\s*/, "")})`,
        `Day #: ${els.dayNumber.textContent} — ${els.percentPill.textContent} complete`,
        `Completed: ${els.done.textContent} / ${els.totalDaysMeta.textContent} days`,
        `Remaining: ${els.left.textContent} days`,
        `Start (Day 1): ${els.startText.textContent}`,
        `End (Final Day): ${els.endText.textContent}`,
        `Share: ${location.href}`,
      ].join("\n");
      try { await navigator.clipboard.writeText(summary); } catch { }
    });

    // .ics
    els.icsBtn.addEventListener("click", () => {
      const iso = els.dateISO.value, tz = els.tz.value, days = Number(els.periodDays.value);
      const v = validate(iso, days, tz); if (!v) return;
      const endOrd = v.sOrd + (days - 1);
      downloadICS({ title: "Notice Period — Final Day", endUTCDate: ordinalToUTCDate(endOrd) });
    });

    // Google Calendar
    els.gcalBtn.addEventListener("click", () => {
      const iso = els.dateISO.value, tz = els.tz.value, days = Number(els.periodDays.value);
      const v = validate(iso, days, tz); if (!v) return;
      const endOrd = v.sOrd + (days - 1);
      openGoogleCalendar("Notice Period — Final Day", ordinalToUTCDate(endOrd));
    });

    // Share
    els.shareBtn.addEventListener("click", async () => {
      try { await navigator.share?.({ title: document.title, url: location.href }); } catch { }
    });

    // Reset
    els.resetBtn.addEventListener("click", () => {
      try { localStorage.removeItem(STORAGE_KEY); } catch { }
      // defaults again
      els.tz.value = "Asia/Kolkata";
      setDateBounds(els.tz.value);
      els.periodDays.value = 90; syncPresetRadiosFromDays(90);
      els.dateISO.value = "2025-10-17";
      els.dateDisplay.value = "17-10-2025";
      hideError();
      recalc();
    });

    // Boot — defaults required by you
    (function boot() {
      initTimeZones();
      setDateBounds("Asia/Kolkata");

      // Defaults: 90 days, Asia/Kolkata, 17-10-2025 (dd-MM-yyyy)
      els.tz.value = "Asia/Kolkata";
      els.periodDays.value = 90; syncPresetRadiosFromDays(90);
      els.dateISO.value = "2025-10-17";
      els.dateDisplay.value = "17-10-2025";

      // Initial render
      recalc();
      // Live clock
      tickNow(); setInterval(tickNow, 1000);
    })();
  </script>
</body>

</html>